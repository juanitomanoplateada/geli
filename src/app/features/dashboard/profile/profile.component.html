<div class="user-profile-container">
  <div class="profile-card">
    <h1>Perfil de Usuario</h1>

    <!-- SecciÃ³n de datos personales -->
    <div class="profile-section">
      <h3>InformaciÃ³n Personal</h3>
      <div class="profile-data-grid">
        <div class="profile-data-row">
          <span class="data-label">Nombre Completo:</span>
          <span class="data-value">{{ userProfile.fullName }}</span>
        </div>
        <div class="profile-data-row">
          <span class="data-label">IdentificaciÃ³n:</span>
          <span class="data-value">{{ userProfile.userId }}</span>
        </div>
        <div class="profile-data-row">
          <span class="data-label">Correo Institucional:</span>
          <span class="data-value">{{ userProfile.institutionalEmail }}</span>
        </div>
        <div class="profile-data-row">
          <span class="data-label">Estado del Perfil:</span>
          <span class="data-value">{{ userProfile.userStatus }}</span>
        </div>
        <div class="profile-data-row">
          <span class="data-label">Rol:</span>
          <span class="data-value">{{ userProfile.role }}</span>
        </div>
      </div>
    </div>

    <!-- SecciÃ³n para cambio de contraseÃ±a -->
    <div class="profile-section">
      <h3>Cambio de ContraseÃ±a</h3>
      <form
        class="password-change-form"
        (ngSubmit)="changePassword()"
        #changePasswordForm="ngForm"
      >
        <!-- ContraseÃ±a actual -->
        <div class="form-group">
          <label for="currentPassword" class="form-label"
            >ContraseÃ±a Actual:</label
          >
          <div class="password-wrapper">
            <input
              [type]="showCurrentPassword ? 'text' : 'password'"
              id="currentPassword"
              class="form-input password-field"
              name="currentPassword"
              [(ngModel)]="currentPassword"
              (input)="onCurrentPasswordInput()"
              placeholder="Ingrese la contraseÃ±a actual"
              required
            />
            <span
              class="toggle-icon"
              (click)="togglePasswordVisibility('current')"
            >
              {{ showCurrentPassword ? "ğŸ™ˆ" : "ğŸ‘ï¸" }}
            </span>
          </div>
        </div>

        <!-- Nueva contraseÃ±a y confirmaciÃ³n (se muestran si hay algo ingresado en la actual) -->
        <div *ngIf="currentPassword.trim()">
          <div class="form-group">
            <label for="newPassword" class="form-label"
              >Nueva ContraseÃ±a:</label
            >
            <div class="password-wrapper">
              <input
                [type]="showNewPassword ? 'text' : 'password'"
                id="newPassword"
                class="form-input password-field"
                name="newPassword"
                [(ngModel)]="newPassword"
                (input)="validatePasswordForm()"
                placeholder="Ingrese la nueva contraseÃ±a"
                required
              />
              <span
                class="toggle-icon"
                (click)="togglePasswordVisibility('new')"
              >
                {{ showNewPassword ? "ğŸ™ˆ" : "ğŸ‘ï¸" }}
              </span>
            </div>
            <div
              *ngIf="newPassword && !isNewPasswordValid"
              class="error-message"
            >
              La contraseÃ±a debe tener al menos 8 caracteres, una mayÃºscula, una
              minÃºscula, un nÃºmero y un carÃ¡cter especial.
            </div>
          </div>

          <div class="form-group">
            <label for="confirmPassword" class="form-label"
              >Confirmar Nueva ContraseÃ±a:</label
            >
            <div class="password-wrapper">
              <input
                [type]="showConfirmPassword ? 'text' : 'password'"
                id="confirmPassword"
                class="form-input password-field"
                name="confirmPassword"
                [(ngModel)]="confirmPassword"
                (input)="validatePasswordForm()"
                placeholder="Confirme la nueva contraseÃ±a"
                required
              />
              <span
                class="toggle-icon"
                (click)="togglePasswordVisibility('confirm')"
              >
                {{ showConfirmPassword ? "ğŸ™ˆ" : "ğŸ‘ï¸" }}
              </span>
            </div>
            <div
              *ngIf="confirmPassword && newPassword !== confirmPassword"
              class="error-message"
            >
              Las contraseÃ±as no coinciden.
            </div>
          </div>
        </div>

        <!-- BotÃ³n de acciÃ³n -->
        <button
          class="submit-btn"
          type="submit"
          [disabled]="!canSubmitPasswordChange"
        >
          Cambiar ContraseÃ±a
        </button>

        <!-- Mensaje de Ã©xito o error -->
        <div
          *ngIf="feedbackMessage"
          [ngClass]="
            passwordChangeSuccessful
              ? 'feedback-message success'
              : 'feedback-message error'
          "
        >
          {{ feedbackMessage }}
        </div>
      </form>
    </div>
  </div>
</div>
