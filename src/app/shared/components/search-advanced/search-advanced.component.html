<div class="search-bar">
  <!-- Campo de bÃºsqueda con botÃ³n limpiar -->
  <div class="search-input-wrapper">
    <input
      title="Ingresa la informaciÃ³n correspondiente"
      type="text"
      appInputRules
      [alphanumericWithDash]="true"
      [maxLength]="25"
      [uppercase]="true"
      [noSpaces]="false"
      [(ngModel)]="searchQuery"
      (ngModelChange)="searchQueryChange.emit($event)"
      (keyup.enter)="onSearch()"
      [placeholder]="placeholder || 'Buscar...'"
      class="search-input"
      [disabled]="isLoading"
    />
    <button
      *ngIf="searchQuery"
      type="button"
      class="clear-input-btn"
      (click)="clearInput()"
      aria-label="Limpiar bÃºsqueda"
    >
      âœ–
    </button>
  </div>

  <!-- Botones principales -->
  <div class="search-actions">
    <button class="search-button" (click)="onSearch()" [disabled]="isLoading">
      ğŸ” {{ isLoading ? "Buscando..." : "Buscar" }}
    </button>

    <button
      class="advanced-search-btn"
      (click)="onToggleAdvanced()"
      [disabled]="isLoading"
    >
      {{ showAdvancedSearch ? "Ocultar filtros" : "BÃºsqueda avanzada" }}
    </button>
  </div>

  <!-- PaginaciÃ³n -->
  <div class="pagination-controls">
    <button
      (click)="onPageChange(currentPage - 1)"
      [disabled]="currentPage === 0"
    >
      â—€ Anterior
    </button>

    <span>PÃ¡gina {{ currentPage + 1 }} de {{ totalPages }}</span>

    <button
      (click)="onPageChange(currentPage + 1)"
      [disabled]="currentPage + 1 >= totalPages"
    >
      Siguiente â–¶
    </button>

    <select
      title="Selecciona cantidad por pÃ¡gina"
      [ngModel]="pageSize"
      (ngModelChange)="onPageSizeChange($event)"
    >
      <option *ngFor="let size of pageSizeOptions" [value]="size">
        {{ size }} por pÃ¡gina
      </option>
    </select>
  </div>
  <button
    class="refresh-button"
    (click)="onRefresh()"
    [disabled]="isLoading"
    title="Refrescar bÃºsqueda"
  >
    ğŸ”„
  </button>
</div>

<!-- Panel de filtros avanzados -->
<div *ngIf="showAdvancedSearch" class="advanced-search">
  <!-- SecciÃ³n para seleccionar filtros visibles -->
  <app-advanced-search-filters
    [availableFilters]="availableFilterKeys"
    [activeFilters]="activeFilterKeys"
    (activeFiltersChange)="onActiveFiltersChange($event)"
  ></app-advanced-search-filters>

  <!-- Renderizado de campos activos -->
  <app-search-advanced-fields
    [filters]="filters"
    [options]="options"
    [fieldsConfig]="activeFieldsConfig"
    [isLoading]="isLoading"
    (filtersChange)="filtersChange.emit($event)"
  ></app-search-advanced-fields>

  <!-- BotÃ³n para limpiar filtros -->
  <div class="filter-actions">
    <button
      class="clear-filters-btn"
      (click)="onClear()"
      [disabled]="isLoading"
    >
      Limpiar filtros
    </button>
  </div>
</div>
